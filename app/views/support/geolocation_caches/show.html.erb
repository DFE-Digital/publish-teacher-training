<%= content_for :page_title, title_with_error_prefix(I18n.t("components.page_titles.support.providers.edit_contact"), @provider&.errors&.any?) %>

<%= content_for(:before_content) do %>
  <%= govuk_breadcrumbs(breadcrumbs: [
      govuk_breadcrumb_link_to("Support", support_recruitment_cycle_index_path),
      govuk_breadcrumb_link_to("Settings", support_settings_path),
    ]) %>
<% end %>

<h1 class="govuk-heading-l"><%= t(".page_title") %></h1>

<div>

  <%= govuk_summary_list do |list| %>
    <% list.with_row do |row| %>
      <% row.with_key(text: "Number of entries") %>
      <% row.with_value do %>
        <div class="govuk-body"><%= @count %></div>
      <% end %>
    <% end %>
    <% list.with_row do |row| %>
      <% row.with_key(text: "Expiry") %>
      <% row.with_value do %>
        <div class="govuk-body"><%= @count_expires_at.to_fs(:long) %> (<%= distance_of_time_in_words_to_now(@count_expires_at) %>)</div>
      <% end %>
    <% end %>
    <% list.with_row do |row| %>
      <% row.with_key(text: "Sample of entries (max 100)") %>
      <% row.with_value do %>
        <ul class="govuk-list">
          <% @entries.take(100).uniq.each do |entry| %>
            <li class="code"><%= entry %></li>
          <% end %>
        </ul>
      <% end %>
    <% end %>
  <% end %>

  <div class="govuk-button-group">
    <%= govuk_button_to "Refresh stats", support_geolocation_cache_path, local: true, method: :put, class: "govuk-button--info" %>
    <%= govuk_link_to "Delete cache", delete_support_geolocation_cache_path, local: true, class: "govuk-button govuk-button--warning" %>
  </div>
</div>
